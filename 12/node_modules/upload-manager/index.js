const {EventEmitter} = require('events');
const {inherits} = require('util');

module.exports = {
      UploadManager
    , showText: show    
};

function UploadManager(){
    let _this = this;

    console.log('Upload Manager');

    this.upload = (url)=>{
        let progress  = 0,
            fileSize = 0;

        console.log(`Upload started ${url}`);
        const progressInterval = setInterval(()=>{
            progress += 20;
            fileSize += 50;

            _this.emit('progress', {progress, 'size':fileSize});

            if( progress === 100 ){
                clearInterval(progressInterval);
                _this.emit('end', fileSize);  
            }
            
        },1000);
    };
}


inherits(UploadManager, EventEmitter);

function show(text){
    console.log(text);
}